<%- include('partials/header') %>
<header
  class="mx-auto flex h-16 max-w-4xl items-center gap-8 px-4 sm:px-6 lg:px-8 justify-between"
>
  <h1 class="font-semibold">Blog <span class="text-teal-500">POSTS</span></h1>
  <button
    id="newPostModalTrigger"
    type="button"
    class="rounded bg-blue-600 px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-blue-700"
  >
    Postingan Baru
  </button>
</header>

<main
  class="mx-auto flex flex-col max-w-4xl items-center gap-4 px-4 sm:px-6 lg:px-8"
>
  <% if (posts.length === 0) { %>
  <div
    role="alert"
    class="rounded-md border border-blue-500 bg-blue-50 p-4 shadow-sm w-full"
  >
    <div class="flex items-start gap-4">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 24 24"
        stroke-width="1.5"
        stroke="currentColor"
        class="-mt-0.5 size-6 text-blue-700"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"
        ></path>
      </svg>

      <div class="flex-1">
        <strong class="block leading-tight font-medium text-blue-800">
          Info
        </strong>

        <p class="mt-0.5 text-sm text-blue-700">Belum ada postingan apapun!</p>
      </div>
    </div>
  </div>
  <% } else { posts.forEach(post => { %>
  <article class="rounded-[10px] border border-gray-200 bg-white p-4 w-full">
    <time
      datetime="<%= post.createdAt.toISOString() %>"
      class="block text-xs text-gray-500"
    >
      <%= post.createdAt.toLocaleString('id-ID', { year: 'numeric', month:
      'long', day: 'numeric', hour: '2-digit', minute: '2-digit' }) %>
    </time>

    <a href="/post/<%= post.id %>">
      <h3 class="mt-0.5 text-lg font-medium text-gray-900">
        <%= post.title %>
      </h3>
    </a>

    <div class="flex gap-2">
      <form
        action="/post/<%= post.id %>?_method=DELETE"
        method="post"
        onsubmit="return confirm('Apakah Anda yakin ingin menghapus postingan ini?')"
      >
        <button
          type="submit"
          class="mt-4 rounded bg-red-600 px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-red-700"
        >
          Hapus
        </button>
      </form>
      <button
        data-editing-id="<%= post.id %>"
        data-title="<%= post.title %>"
        data-content="<%= post.content %>"
        type="button"
        class="edit-btn mt-4 rounded bg-amber-600 px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-amber-700"
      >
        Edit
      </button>
    </div>
  </article>
  <% }) } %>
</main>

<dialog
  id="newPostModal"
  class="w-full max-w-md rounded-lg bg-white p-6 shadow-lg backdrop:bg-black/50 m-auto"
>
  <div class="flex items-start justify-between">
    <h2 class="text-xl font-bold text-gray-900 sm:text-2xl">Postingan Baru</h2>

    <form method="dialog">
      <button
        class="-me-4 -mt-4 rounded-full p-2 text-gray-400 transition-colors hover:bg-gray-50 hover:text-gray-600 focus:outline-none"
        aria-label="Close"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="size-5"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M6 18L18 6M6 6l12 12"
          ></path>
        </svg>
      </button>
    </form>
  </div>

  <form
    id="postForm"
    class="mt-4 block space-y-4"
    method="post"
    action="/create"
  >
    <label for="title" class="block">
      <span class="text-sm font-medium text-gray-700"> Judul Postingan </span>
      <input
        type="text"
        id="title"
        name="title"
        placeholder="Masukkan judul postingan..."
        class="mt-0.5 w-full rounded border-gray-300 shadow-sm sm:text-sm"
        required
      />
    </label>
    <label for="content" class="block">
      <span class="text-sm font-medium text-gray-700">Isi Postingan</span>
      <textarea
        type="text"
        id="content"
        name="content"
        placeholder="Masukkan isi postingan..."
        rows="8"
        class="mt-0.5 w-full rounded border-gray-300 shadow-sm sm:text-sm"
        required
      ></textarea>
    </label>
  </form>

  <footer class="mt-6 flex justify-end gap-2">
    <form method="dialog">
      <button
        class="rounded bg-gray-100 px-4 py-2 text-sm font-medium text-gray-700 transition-colors hover:bg-gray-200"
      >
        Batal
      </button>
    </form>

    <button
      type="submit"
      form="postForm"
      class="rounded bg-blue-600 px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-blue-700"
    >
      Posting
    </button>
  </footer>
</dialog>
<%- include('partials/footer') %>
